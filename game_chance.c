#include <stdio.h>
#include <string.h>
#include <fcntl.h>
#include <sys/stat.h>
#include <time.h>
#include <stdlib.h>
#include "hackign.h"

#define DATAFILE '/var/chance.data'

struct user {
  int uid;
  int credits;
  int highscore;
  char name[100];
  int (*current_game)();
}

int get_player_data();
void register_new_player();
void update_player_data();
void show_highscore();
void jackpot();
void input_name();
void print_cards(char *, char *, imt);
int take_wager(int, int);
void play_the_game();
int pick_a_number();
int dealer_no_match();
int find_the_ace();
void fatal(char *);

struct user player;

int get_player_data(){
  int fd, uid, read_bytes;
  struct user entry;

  uid = getuid();
  
  fd = open(DATAFILE, O_RDONLY);
  if(fd == -1) return -1;

  read_bytes = read(fd, &entry, sizeof(struct user));
  while(entry.uid != uid && read_bytes > 0) {
    read_bytes = read(fd, &entry, sizeof(struct user));
  }
  close(fd);
  if(read_bytes < sizeof(struct user)){
    return -1;
  }else{
    player = entry;
    return 1;
  }
}
